root:
  critical:
    basicConstraints: 'CA:TRUE'
    keyUsage:         'keyCertSign,cRLSign'
  non_critical:
    subjectKeyIdentifier: 'hash'

subca:
  critical:
    basicConstraints: 'CA:TRUE,pathlen:0'
    keyUsage:         'keyCertSign,cRLSign'
  non_critical:
    subjectKeyIdentifier:   'hash'
    extendedKeyUsage:       'clientAuth,serverAuth'
    authorityKeyIdentifier: 'keyid:always'
    authorityInfoAccess:    'caIssuers;URI.0=<%= ENV['AIA_URL'] %>,OCSP;URI.0=<%= ENV['OCSP_URL'] %>'
    crlDistributionPoints:  'URI.0=<%= ENV['CRL_URL'] %>'
    # XXX what the weird notation, had to change `IP.0=` to `IP.0:`
    nameConstraints:        'excluded;IP:0.0.0.0/0.0.0.0,excluded;IP:0:0:0:0:0:0:0:0/0:0:0:0:0:0:0:0'

ocsp:
  critical:
    basicConstraints: 'CA:false'
    keyUsage:         'digitalSignature'
  non_critical:
    authorityKeyIdentifier: 'keyid:always'
    extendedKeyUsage:       'OCSPSigning'
    noCheck:                'yes'
